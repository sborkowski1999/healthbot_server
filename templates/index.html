<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
	<title>HealthBot Client</title>
	<style>
    .container {
      max-width: 600px;
      margin: 0 auto;
      padding: 20px;
    }

    #map-container {
      width: 100%;
      height: 300px;
      background-color: lightgray;
    }

    #map-image {
      max-width: 100%;
      max-height: 100%;
    }

    #status-label {
      font-size: 18px;
      margin-top: 10px;
    }

    #ontime-label {
      font-size: 18px;
      margin-top: 10px;
    }

    #emergency-button {
      display: block;
      width: 240px;
      height: 80px;
      margin: 20px auto;
      background-color: red;
      color: white;
      font-size: 20px;
      font-weight: bold;
      border: none;
      border-radius: 5px;
    }
  </style>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.1.1/socket.io.js">
        document.querySelector("link[rel='icon']").href = "/favicon.ico";
    </script>
</head>

<body>
    <h1>Healthbot Destination</h1>

    
	<body>
  <div class="container">
    <div id="map-container"><img id="map-image" src="/static/map_image.jpg" alt="Map Image"></div>
    <div id="status-label">Status:</div>
    <div id="ontime-label">On Time:</div>
    <button id="emergency-button">EMERGENCY STOP</button>
  </div>
</body>

    <script>
        var socket = io.connect(location.protocol + '//' + document.domain + ':' + location.port);

        socket.on('connect', function() {
            console.log('Connected to the server');
        });

        /*socket.on('map_update', function(map_image) {
            if (map_image) {
                document.getElementById('map-image').src = map_image;
            }
        });*/

        var mapContainer = document.getElementById('map-container');

        // Add event listener to the image element
        var mapImage = document.getElementById('map-image');
        mapImage.addEventListener('click', function(event) {
          // Get the position of the image within the container
    // Get the position of the image within the container
    var containerRect = mapContainer.getBoundingClientRect();

    // Get the coordinates where the image was clicked relative to the image itself
    var x = event.offsetX;
    var y = event.offsetY;

    // Create an <img> element for the 'x' indicator
    var xIndicator = document.createElement('img');
    xIndicator.src = '/static/x.png'; // Path to the 'x' image
    xIndicator.className = 'x-indicator';

    // Set the position of the 'x' indicator relative to the image
    xIndicator.style.position = 'absolute';
    xIndicator.style.left = (containerRect.left + x) + 'px';
    xIndicator.style.top = (containerRect.top + y) + 'px';

    // Append the 'x' indicator to the map container
    mapContainer.appendChild(xIndicator);

          // Emit the coordinates to the server
          socket.emit('marker_coordinates', { x: x, y: y });
        });
    </script>
</body>
</html>